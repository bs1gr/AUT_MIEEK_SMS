services:
  backend:
    build:
      context: .
      dockerfile: docker/Dockerfile.backend
    environment:
      # Persist DB to volume
      - DATABASE_URL=sqlite:////data/student_management.db
      # Allow frontend served from compose to call backend
      - CORS_ORIGINS=http://localhost:8080
    volumes:
      - sms_data:/data
    expose:
      - "8000"
    # Optional: uncomment to access backend directly on host
    # ports:
    #   - "8000:8000"

  frontend:
    build:
      context: .
      dockerfile: docker/Dockerfile.frontend
      args:
        - VITE_API_URL=/api/v1
    depends_on:
      - backend
    ports:
      - "8080:80"

volumes:
  sms_data:
    driver: local
