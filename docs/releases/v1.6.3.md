# Release Notes – v1.6.3

## Highlights

- **Legacy release archive surfaced:** Every GitHub release up through v1.6.2 now carries an `ARCHIVED` notice, links back to `archive/README.md`, and consolidates its historical scripts/binaries into a single downloadable bundle for auditors.
- **Obsolete package retirement:** Added guidance (and CLI snippets) for deleting or privatizing the three unused GitHub Packages so downstream deployments stop resolving stale artifacts.
- **Documentation refresh:** README, CHANGELOG, docs/DOCUMENTATION_INDEX.md, and the operations guides now reference v1.6.3 as the active release and explain how to promote the archive when tagging future versions.
- **Release automation hooks:** This file serves as the canonical release-notes source so `gh release create v1.6.3 --notes-file docs/releases/v1.6.3.md` publishes the exact same content you read in-repo.

## Operator Notice – Legacy Assets

Releases at or below v1.6.2 are no longer supported. Their setup/stop wrappers, emergency helper scripts, and other deprecated assets live exclusively under [`archive/`](../../archive/README.md). Do **not** execute those files in production; they exist only for historical reference. All supported workflows continue to use `RUN.ps1`, `scripts/dev/run-native.ps1`, and `SMS.ps1`.

## Upgrade Notes

1. **Archive the old releases/packages:** Before cutting this tag, run `pwsh -NoProfile -File scripts/ops/archive-releases.ps1 -DryRun` to preview the archival banner for every legacy release (you can point `-ReleasesJsonPath` at `scripts/ops/samples/releases.sample.json` when testing offline), then rerun without `-DryRun` to apply the changes. Afterwards, delete/privatize the three unused GitHub Packages.
2. **Publish directly from the repo:** Run `gh release create v1.6.3 --title "v1.6.3 – Release archive + cleanup" --notes-file docs/releases/v1.6.3.md` (attach any current artifacts you ship with RUN/SMART_SETUP).
3. **Point operators to the archive:** Reference the archive release in deployment runbooks and let automation teams know that only `v1.6.3` (and later) should be pulled moving forward.
4. **Re-run the test suites:** Backend `pytest -q` and frontend `npm run test -- --runInBand` should both be green before tagging.

## Automating the Archive Sweep

Prefer to run the archival helper from GitHub Actions so auditors can review the immutable job log. From the repository's **Actions** tab trigger **Archive legacy releases**, keep the default `threshold_tag` of `v1.6.2`, and execute the workflow once with `dry_run=true` to capture the pending changes table. When the summary looks correct, re-run the workflow with `dry_run=false`; it will invoke `scripts/ops/archive-releases.ps1` on the checked-out `main` branch and push the warning banner plus prerelease toggle to every matching release.

## Removing Legacy GitHub Packages

All three historical GHCR images (`sms-backend`, `sms-frontend`, `sms-fullstack`) must be deleted or privatized so automation does not pull them accidentally. Run `pwsh -NoProfile -File scripts/ops/remove-legacy-packages.ps1 -DryRun` to see the pending actions (optional: `-PackageDataPath scripts/ops/samples/package-versions.sample.json` for offline simulation), then rerun without `-DryRun` (or with `-Privatize`) once you're ready. Under the hood the script executes the same GitHub CLI calls outlined below, so you can also run the commands manually if you prefer:

```powershell
# List every version ID under a package
gh api `
  -H "Accept: application/vnd.github+json" `
  "/orgs/bs1gr/packages/container/sms-backend/versions" `
  --jq '.[].id'

# Delete all versions for a package (repeat for sms-frontend / sms-fullstack)
$package = "sms-backend"
$versionIds = gh api `
  -H "Accept: application/vnd.github+json" `
  "/orgs/bs1gr/packages/container/$package/versions" `
  --jq '.[].id'
foreach ($id in $versionIds) {
  gh api --method DELETE `
    -H "Accept: application/vnd.github+json" `
    "/orgs/bs1gr/packages/container/$package/versions/$id"
}
```

If you prefer to retain the artifacts privately (instead of deleting them), call `gh api --method PATCH` with `{"visibility":"private"}` against `/orgs/bs1gr/packages/container/<package>` rather than running the DELETE loop above.
