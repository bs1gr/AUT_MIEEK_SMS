# Pre-Deployment Execution Walkthrough (Jan 8, 2026)

**Timeline**: January 8, 2026 (1-2 hours)
**Reference**: [PRE_DEPLOYMENT_VALIDATION_CHECKLIST.md](PRE_DEPLOYMENT_VALIDATION_CHECKLIST.md)
**Owner**: DevOps Lead / Tech Lead
**Status**: Ready for execution

---

## üìã Phase 1: Repository & Code Verification (15 minutes)

### Step 1.1: Repository Status Check
**Checklist Item**: "Repository Status: Git status clean"

```powershell
# Execute in PowerShell
cd d:\SMS\student-management-system
git status
```

**Expected Output**:
```
On branch main
Your branch is up to date with 'origin/main'.
nothing to commit, working tree clean
```

**If Output Differs**:
- ‚ùå Uncommitted changes present
  - Action: `git stash` to save, or commit before proceeding
  - Decision: Cannot proceed until clean

### Step 1.2: Version File Verification
**Checklist Item**: "Version file contains: 1.15.1"

```powershell
# Read VERSION file
Get-Content VERSION
```

**Expected Output**:
```
1.15.1
```

**If Output Differs**:
- ‚ùå Version is 1.15.0 or other
  - Action: Version file was not updated during release prep
  - Decision: Contact release manager before proceeding
  - Fix: `echo "1.15.1" | Set-Content VERSION` (if authorized)

### Step 1.3: CHANGELOG Verification
**Checklist Item**: "CHANGELOG.md contains v1.15.2 entry"

```powershell
# Check for $11.15.2 in CHANGELOG
Select-String "## \[1.15.1\]" CHANGELOG.md | Select-Object -First 1
```

**Expected Output**:
```
## [1.15.1] - 2026-01-07
```

**If Output Differs**:
- ‚ö†Ô∏è v1.15.2 entry missing
  - Action: Verify release notes were created
  - Decision: Proceed with caution, document issue for v1.15.2

### Step 1.4: Key Files Presence Check
**Checklist Item**: "Release files present and readable"

```powershell
# Check release documentation exists
$requiredFiles = @(
  "docs/releases/RELEASE_NOTES_v1.15.2.md",
  "docs/deployment/STAGING_DEPLOYMENT_PLAN_v1.15.2.md",
  "docs/deployment/PRE_DEPLOYMENT_VALIDATION_CHECKLIST.md"
)

foreach ($file in $requiredFiles) {
  if (Test-Path $file) {
    Write-Host "‚úÖ $file exists"
  } else {
    Write-Host "‚ùå $file MISSING"
  }
}
```

**Expected Output**:
```
‚úÖ docs/releases/RELEASE_NOTES_$11.15.2.md exists
‚úÖ docs/deployment/STAGING_DEPLOYMENT_PLAN_$11.15.2.md exists
‚úÖ docs/deployment/PRE_DEPLOYMENT_VALIDATION_CHECKLIST.md exists
```

**If Output Differs**:
- ‚ùå Files missing
  - Action: Locate missing files or regenerate from templates
  - Decision: Cannot proceed without deployment plan
  - Contact: Tech lead for file recovery

### Step 1.5: Git Log Verification
**Checklist Item**: "Recent commits contain release-related changes"

```powershell
# Show last 5 commits
git log --oneline -5
```

**Expected Output** (should show recent commits like):
```
ae8c37b67 docs: Complete Phase 2 planning with swimlanes and dependencies
4d78ddfa4 docs: Create Phase 2 swimlanes, dependencies, and critical path analysis
cda3d264c docs: Create comprehensive project status summary (Jan 7, 2026)
8aea7bcf8 docs: Update UNIFIED_WORK_PLAN.md with Phase 2 detailed task breakdown
3b9d44fd5 docs: Prepare $11.15.2 release package
```

**If Output Differs**:
- ‚ö†Ô∏è Commits missing or out of order
  - Action: Verify commits were pushed to origin/main
  - Decision: Run `git pull origin main` to sync
  - Decision: Cannot deploy if commits not on main

---

## üèóÔ∏è Phase 2: Infrastructure Verification (20 minutes)

### Step 2.1: Docker Installation Check
**Checklist Item**: "Docker installed and running"

```powershell
# Check Docker version
docker --version
docker ps
```

**Expected Output**:
```
Docker version 27.0.0 or higher
CONTAINER ID   IMAGE      COMMAND   STATUS
(empty if no containers running - that's OK)
```

**If Docker Not Found**:
- ‚ùå Docker not installed
  - Action: Install Docker Desktop from docker.com
  - Decision: Cannot proceed without Docker
  - Effort: 15-30 minutes to install and verify

**If Docker Not Running**:
- ‚ùå Docker daemon not started
  - Action: Start Docker Desktop application
  - Decision: Wait 30 seconds for startup, retry
  - Effort: 2 minutes

### Step 2.2: Port Availability Check
**Checklist Item**: "Required ports available (8080, 5432)"

```powershell
# Check if ports are in use
netstat -ano | findstr ":8080"
netstat -ano | findstr ":5432"
```

**Expected Output**:
```
(Empty output = port available)
```

**If Ports In Use**:
- ‚ö†Ô∏è Port already bound
  - Action: `DOCKER.ps1 -Stop` to stop existing containers
  - Decision: Confirm which application uses port
  - Effort: 2 minutes

**If Uncertain**:
- ‚ö†Ô∏è Ports show LISTENING
  - Action: Verify if it's old SMS container (`docker ps`)
  - Decision: Safe to restart if it's SMS
  - Effort: 1 minute

### Step 2.3: Disk Space Verification
**Checklist Item**: "Disk space ‚â•5GB available"

```powershell
# Check disk space on D: drive
Get-Volume D | Select-Object SizeRemaining, Size |
  ForEach-Object {
    $free = [math]::Round($_.SizeRemaining / 1GB, 2)
    $total = [math]::Round($_.Size / 1GB, 2)
    Write-Host "D: Drive - $free GB free / $total GB total"
  }
```

**Expected Output**:
```
D: Drive - 250.5 GB free / 500 GB total
```

**If Less Than 5GB Free**:
- ‚ùå Insufficient disk space
  - Action: Clean up temporary files, old Docker images
  - Command: `docker system prune -a` (warning: removes all unused images)
  - Decision: Cannot deploy with <5GB free
  - Effort: 10-15 minutes

### Step 2.4: Network Connectivity Check
**Checklist Item**: "Network connectivity to GitHub and registries"

```powershell
# Test GitHub connectivity
Test-NetConnection github.com -Port 443

# Test Docker Hub connectivity
Test-NetConnection docker.io -Port 443
```

**Expected Output**:
```
ComputerName     : github.com
RemotePort       : 443
TcpTestSucceeded : True
```

**If TcpTestSucceeded = False**:
- ‚ùå Network unreachable
  - Action: Check VPN, firewall, proxy settings
  - Decision: Cannot pull Docker images without network access
  - Effort: 5-10 minutes to diagnose

### Step 2.5: Environment Files Check
**Checklist Item**: ".env files present in backend and frontend"

```powershell
# Check backend .env
if (Test-Path "backend/.env") {
  Write-Host "‚úÖ backend/.env exists"
} else {
  Write-Host "‚ùå backend/.env MISSING - copy from backend/.env.example"
  Copy-Item "backend/.env.example" "backend/.env"
}

# Check frontend .env
if (Test-Path "frontend/.env") {
  Write-Host "‚úÖ frontend/.env exists"
} else {
  Write-Host "‚ö†Ô∏è frontend/.env MISSING - check if needed"
}
```

**Expected Output**:
```
‚úÖ backend/.env exists
‚úÖ frontend/.env exists
```

**If Files Missing**:
- ‚ö†Ô∏è .env files not configured
  - Action: Copy from .env.example templates
  - Decision: Frontend .env optional (has defaults)
  - Effort: 2 minutes

---

## üíæ Phase 3: Database & Data Verification (15 minutes)

### Step 3.1: Database Backup Verification
**Checklist Item**: "Database backup created pre-1.15.1"

```powershell
# Check for backups
Get-ChildItem "backend/backups/" -Filter "*.db.bak" |
  Sort-Object LastWriteTime -Descending |
  Select-Object -First 5 |
  ForEach-Object {
    $size = [math]::Round($_.Length / 1MB, 2)
    Write-Host "$($_.Name) - $size MB - Modified: $($_.LastWriteTime)"
  }
```

**Expected Output**:
```
student_management_2026-01-07_backup.db.bak - 2.5 MB - Modified: 2026-01-07 14:30:00
student_management_2026-01-06_backup.db.bak - 2.5 MB - Modified: 2026-01-06 20:15:00
```

**If No Backups Found**:
- ‚ùå No database backup exists
  - Action: Create backup immediately
  - Command: `Copy-Item "data/student_management.db" "backend/backups/student_management_2026-01-07_backup.db.bak"`
  - Decision: Cannot proceed without recent backup

**If Backup Size < 100KB**:
- ‚ùå Backup file corrupted or empty
  - Action: Verify backup created successfully
  - Command: Recreate backup
  - Decision: Investigate why DB so small

### Step 3.2: Database File Status Check
**Checklist Item**: "Current database file readable and valid"

```powershell
# Check database file
if (Test-Path "data/student_management.db") {
  $dbSize = (Get-Item "data/student_management.db").Length / 1MB
  Write-Host "‚úÖ Database file exists ($dbSize MB)"

  # Attempt to connect (requires Python)
  # This would verify integrity
} else {
  Write-Host "‚ùå Database file not found at data/student_management.db"
}
```

**Expected Output**:
```
‚úÖ Database file exists (2.5 MB)
```

**If Database Missing**:
- ‚ùå Database not initialized
  - Action: Restore from backup or let application initialize
  - Decision: Application will auto-initialize on startup
  - Note: First startup will be slow (migration running)

### Step 3.3: Test Data Verification
**Checklist Item**: "Test data exists (at least 50 students)"

```powershell
# Run Python script to count records
python -c "
import sys
sys.path.insert(0, 'backend')
from db import SessionLocal
from models import Student

db = SessionLocal()
count = db.query(Student).count()
print(f'Students in database: {count}')
if count >= 50:
    print('‚úÖ Test data exists')
else:
    print(f'‚ö†Ô∏è Only {count} students (need ‚â•50 for realistic testing)')
"
```

**Expected Output**:
```
Students in database: 150
‚úÖ Test data exists
```

**If Test Data Missing**:
- ‚ö†Ô∏è Database empty
  - Action: Seed test data before deployment
  - Command: `python backend/seed_e2e_data.py`
  - Decision: Can proceed but E2E tests will be limited

**If Count < 50**:
- ‚ö†Ô∏è Insufficient test data
  - Action: Run seed script to populate
  - Effort: 5 minutes

### Step 3.4: Database Constraints Check
**Checklist Item**: "Database constraints and indexes exist"

```powershell
# Verify via Alembic (database is at latest version)
cd backend
alembic current
cd ..
```

**Expected Output**:
```
(head)
```

**If Not at Head**:
- ‚ö†Ô∏è Migrations not applied
  - Action: Run migrations
  - Command: `cd backend && alembic upgrade head && cd ..`
  - Decision: Cannot deploy with unapplied migrations
  - Effort: 5 minutes

---

## üìö Phase 4: Documentation Verification (10 minutes)

### Step 4.1: Release Notes Readability
**Checklist Item**: "Release notes are clear and complete"

```powershell
# Check release notes length and content
$notes = Get-Content "docs/releases/RELEASE_NOTES_v1.15.2.md"
$lineCount = @($notes).Count
Write-Host "Release notes: $lineCount lines"

# Check for key sections
if ($notes -match "## Features") { Write-Host "‚úÖ Features section present" }
if ($notes -match "## Bug Fixes") { Write-Host "‚úÖ Bug Fixes section present" }
if ($notes -match "## Migration") { Write-Host "‚úÖ Migration guide present" }
```

**Expected Output**:
```
Release notes: 650 lines
‚úÖ Features section present
‚úÖ Bug Fixes section present
‚úÖ Migration guide present
```

**If Sections Missing**:
- ‚ö†Ô∏è Incomplete release notes
  - Action: Add missing sections
  - Decision: Can proceed but document quality lower
  - Effort: 15 minutes to complete

### Step 4.2: Deployment Plan Readability
**Checklist Item**: "Deployment plan clear and actionable"

```powershell
# Verify deployment plan structure
$plan = Get-Content "docs/deployment/STAGING_DEPLOYMENT_PLAN_v1.15.2.md"
Write-Host "Deployment plan: $(@($plan).Count) lines"

# Check phases
if ($plan -match "Phase 1") { Write-Host "‚úÖ Phase 1 documented" }
if ($plan -match "Phase 2") { Write-Host "‚úÖ Phase 2 documented" }
if ($plan -match "Rollback") { Write-Host "‚úÖ Rollback procedure documented" }
```

**Expected Output**:
```
Deployment plan: 400 lines
‚úÖ Phase 1 documented
‚úÖ Phase 2 documented
‚úÖ Rollback procedure documented
```

### Step 4.3: API Documentation Current
**Checklist Item**: "API documentation updated for v1.15.2"

```powershell
# Check if CONTROL_API.md mentions $11.15.2 or recent changes
Select-String "1.15" "backend/CONTROL_API.md" -ErrorAction SilentlyContinue | Select-Object -First 1
```

**Expected Output**:
```
(Should show version reference or recent update date)
```

---

## ‚öôÔ∏è Phase 5: Deployment Scripts Verification (10 minutes)

### Step 5.1: PowerShell Script Availability
**Checklist Item**: "DOCKER.ps1 and NATIVE.ps1 present and executable"

```powershell
# Check deployment scripts
if (Test-Path "DOCKER.ps1") {
  Write-Host "‚úÖ DOCKER.ps1 exists"
} else {
  Write-Host "‚ùå DOCKER.ps1 MISSING"
}

if (Test-Path "NATIVE.ps1") {
  Write-Host "‚úÖ NATIVE.ps1 exists"
} else {
  Write-Host "‚ùå NATIVE.ps1 MISSING"
}

# Verify they're readable
Get-Content "DOCKER.ps1" -TotalCount 5 | ForEach-Object { Write-Host $_ }
```

**Expected Output**:
```
‚úÖ DOCKER.ps1 exists
‚úÖ NATIVE.ps1 exists
# DOCKER.ps1
# Comprehensive Docker deployment management script
# Usage: .\DOCKER.ps1 -Help
```

### Step 5.2: Docker Compose Files Check
**Checklist Item**: "Docker Compose files present"

```powershell
# Check docker-compose files
$composeFiles = @(
  "docker/docker-compose.yml",
  "docker/docker-compose.prod.yml"
)

foreach ($file in $composeFiles) {
  if (Test-Path $file) {
    Write-Host "‚úÖ $file exists"
  } else {
    Write-Host "‚ùå $file MISSING"
  }
}
```

**Expected Output**:
```
‚úÖ docker/docker-compose.yml exists
‚úÖ docker/docker-compose.prod.yml exists
```

### Step 5.3: Script Syntax Validation
**Checklist Item**: "Scripts have valid PowerShell syntax"

```powershell
# Quick syntax check on DOCKER.ps1
$errors = @()
$ast = [System.Management.Automation.Language.Parser]::ParseFile(
  (Resolve-Path "DOCKER.ps1"),
  [ref]$null,
  [ref]$errors
)

if ($errors.Count -eq 0) {
  Write-Host "‚úÖ DOCKER.ps1 syntax valid"
} else {
  Write-Host "‚ùå DOCKER.ps1 has syntax errors:"
  $errors | ForEach-Object { Write-Host "  - $_" }
}
```

**Expected Output**:
```
‚úÖ DOCKER.ps1 syntax valid
```

**If Syntax Errors Found**:
- ‚ùå Script has errors
  - Action: Do not execute, contact tech lead
  - Decision: Cannot proceed with invalid scripts

---

## üß™ Phase 6: Pre-Deployment Tests (10 minutes)

### Step 6.1: Docker Image Availability
**Checklist Item**: "Required Docker images are available or can be pulled"

```powershell
# Check if base images available
Write-Host "Checking Docker images..."
docker images | findstr "python"
docker images | findstr "node"
```

**Expected Output**:
```
python        latest    abc123...   2 weeks ago   1.2GB
node          20        def456...   1 month ago   500MB
```

**If Images Not Found**:
- ‚ö†Ô∏è Images not cached locally (will be pulled on first build)
  - Action: This is normal, will pull during `DOCKER.ps1 -Start`
  - Decision: First deploy will be slower (5-10 min extra)
  - Effort: Automatic during deployment

### Step 6.2: Network Connectivity to Docker Registry
**Checklist Item**: "Can reach Docker Hub and GitHub registries"

```powershell
# Test connectivity
Test-NetConnection -ComputerName docker.io -Port 443 -InformationLevel Quiet
Test-NetConnection -ComputerName ghcr.io -Port 443 -InformationLevel Quiet

Write-Host "Docker Hub: $(if ($? -eq $true) {'‚úÖ Accessible'} else {'‚ùå Unreachable'})"
```

**Expected Output**:
```
Docker Hub: ‚úÖ Accessible
```

### Step 6.3: Backend Requirements Check
**Checklist Item**: "Python dependencies specified in requirements.txt"

```powershell
# Check requirements exist
if (Test-Path "backend/requirements.txt") {
  $requirementCount = (Get-Content "backend/requirements.txt" | Measure-Object -Line).Lines
  Write-Host "‚úÖ requirements.txt exists ($requirementCount dependencies)"
} else {
  Write-Host "‚ùå requirements.txt MISSING"
}

# Check requirements.lock
if (Test-Path "backend/requirements-lock.txt") {
  Write-Host "‚úÖ requirements-lock.txt exists (pinned versions)"
} else {
  Write-Host "‚ö†Ô∏è requirements-lock.txt missing (non-critical)"
}
```

**Expected Output**:
```
‚úÖ requirements.txt exists (45 dependencies)
‚úÖ requirements-lock.txt exists (pinned versions)
```

### Step 6.4: Frontend Dependencies Check
**Checklist Item**: "NPM dependencies specified in package.json"

```powershell
# Check package.json
if (Test-Path "frontend/package.json") {
  Write-Host "‚úÖ frontend/package.json exists"

  # Show dependency count (rough)
  $json = Get-Content "frontend/package.json" | ConvertFrom-Json
  $count = $json.dependencies.PSObject.Properties.Count
  Write-Host "  Dependencies: ~$count packages"
} else {
  Write-Host "‚ùå frontend/package.json MISSING"
}

# Check package-lock.json
if (Test-Path "frontend/package-lock.json") {
  Write-Host "‚úÖ frontend/package-lock.json exists (locked versions)"
} else {
  Write-Host "‚ö†Ô∏è package-lock.json missing (will use latest)"
}
```

**Expected Output**:
```
‚úÖ frontend/package.json exists
  Dependencies: ~30 packages
‚úÖ frontend/package-lock.json exists (locked versions)
```

---

## ‚úÖ Phase 7: Final Sign-Off (5 minutes)

### Step 7.1: Compilation of Results
**Create Summary Table**:

| Category | Item | Status | Comment |
|----------|------|--------|---------|
| **Repository** | Git clean | ‚úÖ PASS | No uncommitted changes |
| | Version 1.15.1 | ‚úÖ PASS | Correct version |
| | CHANGELOG entry | ‚úÖ PASS | v1.15.2 documented |
| **Infrastructure** | Docker installed | ‚úÖ PASS | Running |
| | Ports available | ‚úÖ PASS | 8080, 5432 free |
| | Disk space | ‚úÖ PASS | 250GB free |
| | Network connectivity | ‚úÖ PASS | GitHub, Docker Hub reachable |
| **Database** | Backup created | ‚úÖ PASS | 2.5 MB, recent |
| | Test data | ‚úÖ PASS | 150 students |
| | Migrations | ‚úÖ PASS | At (head) |
| **Documentation** | Release notes | ‚úÖ PASS | 650 lines, complete |
| | Deployment plan | ‚úÖ PASS | 400 lines, detailed |
| **Scripts** | DOCKER.ps1 | ‚úÖ PASS | Valid syntax |
| | Docker Compose | ‚úÖ PASS | Files present |
| **Dependencies** | Python deps | ‚úÖ PASS | 45 packages specified |
| | NPM deps | ‚úÖ PASS | ~30 packages locked |

### Step 7.2: Risk Assessment
- ‚úÖ All critical checks PASS
- ‚úÖ No blocking issues identified
- ‚úÖ Infrastructure ready for deployment
- ‚ö†Ô∏è Note: First Docker build will pull images (~5-10 min extra time)

### Step 7.3: GO/NO-GO Decision

**GO CONDITIONS** (All must be true):
- ‚úÖ Git repository clean
- ‚úÖ Version = 1.15.1
- ‚úÖ Docker installed and running
- ‚úÖ Ports 8080, 5432 available
- ‚úÖ Disk space ‚â• 5GB
- ‚úÖ Database backup created (‚â•100KB)
- ‚úÖ Test data exists
- ‚úÖ Migrations at (head)
- ‚úÖ All deployment scripts valid

**DECISION: ‚úÖ GO FOR DEPLOYMENT**

**Authorized By**: [Tech Lead Name], Date: [Date], Time: [Time]

**Next Steps**:
1. Confirm GO decision with stakeholders
2. Proceed to Phase 1 of STAGING_DEPLOYMENT_PLAN_v1.15.2.md
3. Execute `DOCKER.ps1 -Stop` (if containers running)
4. Execute `DOCKER.ps1 -Start` to begin deployment
5. Monitor health checks (expected: 5-10 minutes)

---

## üîÑ If NO-GO Decision Needed

**NO-GO TRIGGERS** (Any of these):
- ‚ùå Git repository not clean
- ‚ùå Version file != 1.15.1
- ‚ùå Docker not installed/running
- ‚ùå Ports 8080 or 5432 in use (and can't be freed)
- ‚ùå Disk space < 5GB
- ‚ùå Database backup missing or <100KB
- ‚ùå Migrations not at (head)
- ‚ùå Invalid PowerShell scripts

**If NO-GO Occurs**:
1. Document issue in DEPLOYMENT_STATUS_TRACKER.md
2. Contact tech lead
3. Create action plan to resolve issue
4. Reschedule validation for next day
5. Do NOT attempt deployment with NO-GO status

---

## üìû Escalation Contacts

| Issue | Contact | Escalation Time |
|-------|---------|-----------------|
| Database backup issues | Database Admin | 30 min |
| Docker/infrastructure | DevOps Lead | 15 min |
| Script syntax errors | Tech Lead | Immediate |
| Network connectivity | Network Admin | 30 min |
| Disk space issues | System Admin | 1 hour |
| Git/repository issues | Git Admin | 15 min |

---

**Document Status**: ‚úÖ Ready for execution
**Created**: January 7, 2026
**Owner**: DevOps Lead
**Next Review**: January 8, 2026 (Day of execution)
