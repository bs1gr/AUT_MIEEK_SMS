# Production Environment Variables Template (no secrets)
# Copy to `.env` or a secrets manager and replace ALL placeholder values.

# ---------------------------------------------------------------------------
# Execution mode
# ---------------------------------------------------------------------------
SMS_ENV=production
SMS_EXECUTION_MODE=docker

# ---------------------------------------------------------------------------
# Security & authentication
# ---------------------------------------------------------------------------
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
SECRET_KEY=REPLACE_WITH_RANDOM_64_CHAR_SECRET
SECRET_KEY_STRICT_ENFORCEMENT=1

# Enable JWT auth + RBAC
AUTH_ENABLED=1
# Options: disabled | permissive | strict (recommended for prod)
AUTH_MODE=strict

# Auto-bootstrap an admin on first start (rotate immediately after login)
DEFAULT_ADMIN_EMAIL=admin@example.com
DEFAULT_ADMIN_PASSWORD=CHANGE_ME_IMMEDIATELY
DEFAULT_ADMIN_FULL_NAME=System Administrator
DEFAULT_ADMIN_FORCE_RESET=1

# ---------------------------------------------------------------------------
# Database (PostgreSQL strongly recommended for production)
# docker-compose.prod.yml builds DATABASE_URL automatically from these
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=student_management
POSTGRES_USER=sms_user
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE  # pragma: allowlist secret
POSTGRES_SSLMODE=require
POSTGRES_OPTIONS=connect_timeout=10&application_name=sms

# Alternative explicit URL (overrides the above when set)
# DATABASE_URL=postgresql+psycopg://sms_user:CHANGE_ME@postgres:5432/student_management  # pragma: allowlist secret

# ---------------------------------------------------------------------------
# CORS / CSRF
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CSRF_ENABLED=1
CSRF_COOKIE_SECURE=1
CSRF_COOKIE_SAMESITE=lax
CSRF_HEADER_NAME=X-CSRF-Token

# ---------------------------------------------------------------------------
# Control API (keep disabled unless you need operator commands)
ENABLE_CONTROL_API=0
ADMIN_SHUTDOWN_TOKEN=SET_STRONG_TOKEN_IF_ENABLED
ALLOW_REMOTE_SHUTDOWN=0
CONTROL_API_ALLOW_TASKKILL=0

# ---------------------------------------------------------------------------
# Metrics & monitoring
ENABLE_METRICS=1

# ---------------------------------------------------------------------------
# Redis (optional, for caching/notifications in multi-node deployments)
REDIS_ENABLED=0
REDIS_URL=redis://redis:6379/0

# ---------------------------------------------------------------------------
# SMTP (optional, for email notifications)
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=
SMTP_USE_TLS=1

# ---------------------------------------------------------------------------
# Build metadata (populated by CI/CD; safe to leave blank)
VERSION=latest
BUILD_DATE=2026-01-09
VCS_REF=main

# ---------------------------------------------------------------------------
# Security checklist
# [ ] Replace SECRET_KEY with a 64+ char random value (do not reuse between envs)
# [ ] Set POSTGRES_PASSWORD to a strong random password (32+ chars)
# [ ] Update DEFAULT_ADMIN_PASSWORD and rotate after first login
# [ ] Set CORS_ORIGINS to your exact production domains
# [ ] Keep this file out of version control with real secrets; prefer vault/secrets
