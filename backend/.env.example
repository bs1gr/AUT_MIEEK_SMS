# Environment Configuration Template
# Copy this file to .env and update with your values

# ==================== APPLICATION ====================
APP_NAME=Student Management System
APP_VERSION=1.0.0
DEBUG=True
ENVIRONMENT=development
SMS_ENV=development
SMS_EXECUTION_MODE=native

# ==================== API SETTINGS ====================
API_HOST=127.0.0.1
API_PORT=8000
API_RELOAD=True

 # ==================== DATABASE ====================
# Primary connection string. Leave blank to use automatic detection:
# - SQLite (default) stored under ./data/student_management.db
# - PostgreSQL (recommended) built from the POSTGRES_* variables below
DATABASE_URL=

# Choose database engine: sqlite (default) or postgresql
DATABASE_ENGINE=sqlite

# PostgreSQL auto-configuration (set DATABASE_ENGINE=postgresql and fill these in)
# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432
# POSTGRES_DB=student_management
# POSTGRES_USER=sms_user
# POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE
# POSTGRES_SSLMODE=prefer
# POSTGRES_OPTIONS=connect_timeout=10&application_name=sms

# Example explicit connection strings (optional)
# DATABASE_URL=sqlite:////data/student_management.db
# DATABASE_URL=postgresql+psycopg://user:password@localhost:5432/student_db

DATABASE_BACKUP_PATH=./backups

# ==================== CORS SETTINGS ====================
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:5173,http://localhost:8000,http://localhost
CORS_CREDENTIALS=True

# ==================== SECURITY ====================
# Generate a secure key: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=your-secret-key-change-this-in-production-use-long-random-string
SECRET_KEY_STRICT_ENFORCEMENT=False
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# ==================== AUTHENTICATION ====================
# Enable JWT-based authentication and role-based access control (RBAC)
# Default: True (recommended for production)
# Set to False only if you want all endpoints public (not recommended)
# See docs/AUTHENTICATION.md for full guide
AUTH_ENABLED=True

# Authorization mode (requires AUTH_ENABLED=True)
# - disabled: No auth checks (same as AUTH_ENABLED=False, legacy mode)
# - permissive: Auth required but any authenticated user can access endpoints (recommended for production)
# - strict: Full role-based access control, endpoints check user roles (use for high-security environments)
AUTH_MODE=permissive

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚  ğŸ” ADMIN LOGIN SETUP - Choose ONE method below:                    â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# METHOD 1: Auto-Bootstrap (Easiest - Recommended for first-time setup)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Automatically creates admin account when application starts.
# Perfect for: Fresh installations, Docker deployments
#
# Steps:
#   1. Uncomment the lines below
#   2. Change the email and password to your preferred credentials
#   3. Start/restart the application
#   4. Login at http://localhost:8080 with your credentials
#   5. IMPORTANT: Change password immediately in Control Panel â†’ Maintenance
#
DEFAULT_ADMIN_EMAIL=admin@example.com
DEFAULT_ADMIN_PASSWORD=YourSecurePassword123!
DEFAULT_ADMIN_FULL_NAME=System Administrator
# DEFAULT_ADMIN_FORCE_RESET=False
#
# METHOD 2: Manual Tool (Alternative for existing databases)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Use the built-in tool to create admin user after startup.
# Perfect for: Adding admins to running systems, multiple admin accounts
#
# Steps:
#   1. Start the application first
#   2. Run one of these commands:
#
#      Docker:
#      docker exec -it sms-app python /app/backend/tools/create_admin.py --email admin@example.com
#
#      Native:
#      python backend/tools/create_admin.py --email admin@example.com --password YourPassword123!
#
#   3. Login at http://localhost:8080 with your credentials
#
# âš ï¸  IMPORTANT NOTES:
# â€¢ Change default passwords immediately after first login!
# â€¢ Keep these credentials secure - admin has full system access
# â€¢ For Docker: Also add these settings to root .env file (not just backend/.env)
# â€¢ AUTH_ENABLED must be True for authentication to work

# Account lockout safeguards (applies even if AUTH_ENABLED=False but you use login endpoints)
AUTH_LOGIN_MAX_ATTEMPTS=5
AUTH_LOGIN_LOCKOUT_SECONDS=300
AUTH_LOGIN_TRACKING_WINDOW_SECONDS=300

# ==================== EMAIL CONFIGURATION ====================
# Gmail example (use App Password, not account password)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@studentmgmt.com

# SendGrid example
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASSWORD=your-sendgrid-api-key

# ==================== ACADEMIC SETTINGS ====================
# Default number of weeks in a semester (1-52). Used to infer date ranges when only one bound is provided.
SEMESTER_WEEKS=14

# ==================== FILE UPLOAD ====================
MAX_UPLOAD_SIZE=10485760
ALLOWED_EXTENSIONS=.csv,.xlsx,.pdf,.doc,.docx

# ==================== LOGGING ====================
LOG_LEVEL=INFO
LOG_FILE=logs/app.log
STARTUP_DEBUG=0  # Set to 1/true to enable verbose startup lifespan logging

# ==================== RATE LIMITING ====================
RATE_LIMIT_ENABLED=True
# New finer-grained rate limit controls (per-minute). These are used by
# backend/rate_limiting.py and let you tune read/write/heavy/auth limits
# independently. If not provided, sensible high-throughput defaults are used.
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_READ_PER_MINUTE=1000
RATE_LIMIT_WRITE_PER_MINUTE=600
RATE_LIMIT_HEAVY_PER_MINUTE=200
RATE_LIMIT_AUTH_PER_MINUTE=50

# ==================== PERFORMANCE ====================
ENABLE_CACHE=True
CACHE_TTL=300
# Response caching middleware
ENABLE_RESPONSE_CACHE=True
RESPONSE_CACHE_TTL_SECONDS=120
RESPONSE_CACHE_MAXSIZE=512
RESPONSE_CACHE_INCLUDE_HEADERS=accept-language,accept
RESPONSE_CACHE_EXCLUDED_PATHS=/control,/health,/health/live,/health/ready
RESPONSE_CACHE_INCLUDE_PREFIXES=/api/v1/analytics,/api/v1/daily-performance,/api/v1/grades/analysis
RESPONSE_CACHE_REQUIRE_OPT_IN=True
RESPONSE_CACHE_OPT_IN_HEADER=x-cache-allow

# ==================== FRONTEND (VITE) ====================
VITE_API_URL=http://localhost:8000
VITE_APP_NAME=Student Management System
VITE_ENABLE_ANALYTICS=false

# ==================== PRODUCTION OVERRIDES ====================
# Uncomment and set for production deployment

# DEBUG=False
# ENVIRONMENT=production
# API_RELOAD=False
# LOG_LEVEL=WARNING
# DATABASE_URL=postgresql://prod_user:secure_password@db-server:5432/student_db_prod
# SECRET_KEY=extremely-long-and-secure-random-string-here
# CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# ==================== MONITORING (Optional) ====================
# Sentry for error tracking
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# Application insights
# APPLICATION_INSIGHTS_KEY=your-application-insights-key

# ==================== EXTERNAL SERVICES (Optional) ====================
# AWS S3 for file storage
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_S3_BUCKET=your-bucket-name
# AWS_REGION=us-east-1

# Redis for caching
# REDIS_URL=redis://localhost:6379/0

# ==================== NOTES ====================
# 1. Never commit .env to version control
# 2. Use different values for development/staging/production
# 3. Keep secrets secure and rotate them regularly
# 4. Use strong passwords and random keys
# 5. Enable 2FA on all external services
