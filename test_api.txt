
> student-management-frontend@1.17.7 pretest
> node ../tools/enforce-vitest-policy.cjs


> student-management-frontend@1.17.7 test
> vitest api.request.interceptor.test.ts


[1m[44m DEV [49m[22m [34mv4.0.16 [39m[90mD:/SMS/student-management-system/frontend[39m

stderr | src/api/__tests__/api.request.interceptor.test.ts
[i18n] Search translation keys loaded: 6 keys

stderr | src/api/__tests__/api.request.interceptor.test.ts
[API Client] VITE_API_URL env var: http://localhost:8000/api/v1
[API Client] Using API_BASE_URL: /api/v1
Using Vite dev proxy for localhost API (CORS-safe): /api/v1

stderr | src/api/__tests__/api.request.interceptor.test.ts > apiClient request interceptor > attaches Authorization header when access token exists
[API] No token available for: 

stderr | src/api/__tests__/api.request.interceptor.test.ts > apiClient request interceptor > does nothing when no token present
[API] No token available for: 

stderr | src/api/__tests__/api.request.interceptor.test.ts > apiClient request interceptor > is resilient if headers missing or getter throws
[API] No token available for: 
[API] No token available for: 

 [31mÎ­Î¶Ïˆ[39m src/api/__tests__/api.request.interceptor.test.ts [2m([22m[2m3 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 6[2mms[22m[39m
[31m     [31mâ”œÎ©[31m attaches Authorization header when access token exists[39m[32m 4[2mms[22m[39m
     [32mÎ­ÎµÎ¥[39m does nothing when no token present[32m 1[2mms[22m[39m
     [32mÎ­ÎµÎ¥[39m is resilient if headers missing or getter throws[32m 1[2mms[22m[39m

Î­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆ Failed Tests 1 Î­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆ

 FAIL  src/api/__tests__/api.request.interceptor.test.ts > apiClient request interceptor > attaches Authorization header when access token exists
AssertionError: expected "getAccessToken" to be called at least once
 Î­Î¶Ïˆ src/api/__tests__/api.request.interceptor.test.ts:16:17
     14| 
     15|     // Assert that the helper consulted the auth service
     16|     expect(spy).toHaveBeenCalled();
       |                 ^
     17|     expect(config.headers.Authorization).toBe('Bearer TOK123');
     18|     spy.mockRestore();

Î­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆÎ­ÎŸÏˆ[1/1]Î­ÎŸÏˆ


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 09:59:40
[2m   Duration [22m 1.31s[2m (transform 148ms, setup 323ms, import 155ms, tests 6ms, environment 656ms)[22m

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
